USE step_1Go--Delete from dbo.MonthlyTotals where table_name = 'txn_2009_08'GoINSERT INTO dbo.MonthlyTotalsSELECT 'txn_2009_08' AS TABLE_NAME	,[FEE_SIGN]	, left(ACQR_BIN, 1) AS BIN	, cpd_month_ID	, case when TRAN_CD = '05' THEN 'Sale' when TRAN_CD = '25' THEN 'Sale Reversal' when TRAN_CD = '06' THEN 'Credit' ELSE 'Other' END as Transaction_Type	, case when USAGE_CD = '1' THEN 'Original' ELSE 'Other' END as Transaction_Usage_Type	, CASE WHEN MRCH_CTRY_CD IN ('840', '850', '630', '316', '16', '016') THEN MRCH_CTRY_CD ELSE '000' END as Merchant_Country_Code   , '0'    , '0'    , '0'    , '0' 	, SUM([SUM_ACQR_US_FEE_AMT]) AS [SUM_ACQR_US_FEE_AMT]	, SUM([SUM_ACQR_FEE_CNT]) AS [SUM_ACQR_FEE_CNT]	, SUM([SUM_ISSR_US_FEE_AMT]) AS [SUM_ISSR_US_FEE_AMT]	, SUM([SUM_ISSR_FEE_CNT]) AS [SUM_ISSR_FEE_CNT]	, SUM([SUM_DRF_US_TRAN_AMT]) AS [SUM_DRF_US_TRAN_AMT]	, SUM([SUM_DRF_TRAN_CNT]) AS [SUM_DRF_TRAN_CN]	, SUM([SUM_DEST_FEE_AMT]) AS [SUM_DEST_FEE_AMT]	, SUM([SUM_DRF_CSHBK_AMT_R]) AS [SUM_DRF_CSHBK_AMT_R]	, SUM([SUM_DRF_CSHBK_CNT]) AS [SUM_DRF_CSHBK_CNT]	, SUM([SUM_DRF_ELAPSE_DAYS]) AS [SUM_DRF_ELAPSE_DAYS]	, SUM([SUM_DRF_INTRCH_FEE_AMT]) AS [SUM_DRF_INTRCH_FEE_AMT]	, SUM([SUM_DRF_NATL_REIMBM_FEE_AMT]) AS [SUM_DRF_NATL_REIMBM_FEE_AMT]	, SUM([SUM_DRF_SRCHG_AMT]) AS [SUM_DRF_SRCHG_AMT]	, SUM([SUM_LCL_SLS_TAX_AMT]) AS [SUM_LCL_SLS_TAX_AMT]	, SUM([SUM_SRCE_FEE_AMT]) AS [SUM_SRCE_FEE_AMT]	, SUM([SUM_DRF_TRAN_AMT]) AS [SUM_DRF_TRAN_AMT]	, SUM([SUM_CCC_ISC_AMT]) AS [SUM_CCC_ISC_AMT]	, SUM([SUM_ACQR_TRAN_AMT]) AS [SUM_ACQR_TRAN_AMT]	, SUM([SUM_ISSR_TRAN_AMT]) AS [SUM_ISSR_TRAN_AMT]	, SUM([SUM_CSHBK_AMT]) AS [SUM_CSHBK_AMT]	, SUM([SUM_DRF_US_TRAN_AMT_NR]) AS [SUM_DRF_US_TRAN_AMT_NR]	, COUNT(*) as TotalRowsFROM txn_2009_08_holdingTableGROUP BY [FEE_SIGN]      , cpd_month_ID      , left(ACQR_BIN, 1)      , case when TRAN_CD = '05' THEN 'Sale' when TRAN_CD = '25' THEN 'Sale Reversal' when TRAN_CD = '06' THEN 'Credit' ELSE 'Other' END      , case when USAGE_CD = '1' THEN 'Original' ELSE 'Other' END       , CASE WHEN MRCH_CTRY_CD IN ('840', '850', '630', '316', '16', '016') THEN MRCH_CTRY_CD ELSE '000' END